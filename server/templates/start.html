<!DOCTYPE html>
<html>
<head>
    <title>Esxtop - ESXI Performance Analyzer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/highstock.js"></script>
    <script src="../static/js/dark-unica.js"></script>
    <script src="../static/js/exporting.js"></script>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/docs.min.css">
    <style type="text/css">
${demo.css}

    </style>
</head>

<body>
    <div id="top" class="navbar navbar-static-top" role="banner">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Esxtop Report</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul id="myTab" class="nav navbar-nav navbar-left nav-pills" role="tablist">
                    <li><a href="#alarms" role="tab" data-toggle="tab">Alarm and Warning</a></li>
                    <li class="active"><a href="#datas" role="tab" data-toggle="tab">Data Overview</a></li>
                    <li><a href="#helps" role="tab" data-toggle="tab">Help</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!--Main Content for data reporting-->
    <div class="container bs-docs-container">
            <div class="tab-content">
                <div class="tab-pane" id="alarms">
                    <div id="allwarning" class="row well"></div>
                </div>
            <div class="tab-pane active" id="datas">
                <div class="row">
                    <!--here is the main statistic info area-->
                    <div class="col-sm-10" role="main">
                        <div class="bs-docs-section">
                            <h1 id="group-overview" class="page-header">Esxtop Data Overview</h1>
                            <h3 id="overview-introduction" >Introduction</h3>
                            <p>EPA(Esxtop Performance Analyzer) is a performance analysis tool which integrates serveral important system profiling software. EPA contains a guest OS side tool(lpa_client) and a server side tool(epa_server). The epa_client is a tool used to install and use profiling packages, and it will collect sample data for further analysis. The lpa_server is a tool used to analysis the sample data collected by lpa_client, and its output is this html file.</p>
                            <p>This report page contains subpages about nearly all aspects of the guest OS's performance, and these subpages are organized by different classes below.</p>
                            <p>Many open-source projects are used in this tool, including oprofile, ftrace, bootstrap, jquery, highcharts and so on.</p>
                        </div>
                        <div class="bs-docs-section">
                            <h1 id="section-1">CPU</h1>
                            <div id="section-1-1" style="width:100%;">
                                <h3>Process Time</h3>
                                <div id="processtime"></div>
                                <br>
                                <div id="cputable1" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-1-2" style="width:100%;">
                                <h3>Util Time</h3>
                                <div id="utiltime"></div>
                                <br>
                                <div id="cputable2" class="row well"></div>
                            </div>
                            
                        </div>
                        <div class="bs-docs-section">
                            <h1 id="section-2">Memory</h1>
                            <div id="section-2-1" style="width:100%;">
                                <h3>Kernel</h3>
                                <div id="kernel"></div>
                                <br>
                                <div id="memorytable1" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-2-2" style="width:100%;">
                                <h3>Nonkernel</h3>
                                <div id="nonkernel"></div>
                                <br>
                                <div id="memorytable2" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-2-3" style="width:100%;">
                                <h3>Kernel State</h3>
                                <div id="kernelstate"></div>
                                <br>
                                <div id="memorytable3" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-2-4" style="width:100%;">
                                <h3>Swap Used</h3>
                                <div id="swapused"></div>
                                <br>
                                <div id="memorytable4" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-2-5" style="width:100%;">
                                <h3>Swap MBytes Read</h3>
                                <div id="swapmbread"></div>
                                <br>
                                <div id="memorytable5" class="row well"></div>
                            </div>
                            <br>
                            <br>
                            <div id="section-2-6" style="width:100%;">
                                <h3>Swap MBytes Write</h3>
                                <div id="swapmbwrite"></div>
                                <br>
                                <div id="memorytable6" class="row well"></div>
                            </div>
                        </div>
                        <!--div class="bs-docs-section">
                            <h1 id="section-3">Warning</h1>
                            <div id="section-3-1">
                                <h3>Warning</h3>
                                <div id="myTable1" class="row well"></div>
                            </div>
                        </div-->
                    </div>

                    <!--here is the sidebar for Affix plugin-->
                    <div class="col-sm-2">
                        <div role="complementary" class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" >
                            <ul class="nav bs-docs-sidenav">
                                <li class="active">
                                    <a href="#group-overview">Overview</a>
                                    <ul class="nav">
                                        <li class="active"><a href="#overview-introduction">Introduction</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#section-1">CPU</a>
                                    <ul class="nav">
                                        <li><a href="#section-1-1">ProcessTime</a></li>
                                        <li><a href="#section-1-2">UtilTime</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#section-2">Memory</a>
                                    <ul class="nav">
                                        <li><a href="#section-2-1">Kernel</a></li>
                                        <li><a href="#section-2-2">NonKernel</a></li>
                                        <li><a href="#section-2-3">Kernel Stateâ€‹</a></li>
                                        <li><a href="#section-2-4">Swap Used</a></li>
                                        <li><a href="#section-2-5">Swap MBytes Read</a></li>
                                        <li><a href="#section-2-6">Swap MBytes Write</a></li>
                                    </ul>
                                </li>
                                <!--li>
                                    <a href="#section-3">Warning</a>
                                    <ul class="nav">
                                        <li><a href="#section-3-1">warning</a></li>
                                    </ul>
                                </li-->





<li><a href="#section">Hardware</a><ul class="nav"><li><a href="#basic_hardware">Hardware Info</a></li><li><a href="#basic_system">System Info</a></li><li><a href="#basic_resource">Resource Info</a></li><li><a href="#setting_resource">Setting Info</a></li></ul><li><li><a href="#lpa_l1_cpuirq">CPU IRQ INFO</a><ul class="nav"><li><a href="#proc_cpu_irq">CPU IRQ Info</a></li></ul><li><li><a href="#lpa_l1_cpu">CPU INFO</a><ul class="nav"><li><a href="#mp_cpu_use_each">CPU Use (Each Core)</a></li><li><a href="#mp_cpu_use_all">CPU Use (All, mpstat)</a></li><li><a href="#sar_cpu_use">CPU Use (All)</a></li><li><a href="#sar_cpu_usrsysnice">CPU Use (User/Sys/Nice)</a></li><li><a href="#sar_cpu_iowait">CPU IO Wait</a></li><li><a href="#sar_cpu_interrupt">CPU Interrupt</a></li></ul><li><li><a href="#lpa_l1_task">TASK INFO</a><ul class="nav"><li><a href="#sar_task_queue">Task Queue Length</a></li><li><a href="#sar_task_number">Task Number</a></li><li><a href="#sar_task_switch">Task Switch</a></li></ul><li><li><a href="#lpa_l1_mem">MEM INFO</a><ul class="nav"><li><a href="#sar_mem_used">Mem Used (kb)</a></li><li><a href="#sar_mem_usepercent">Mem Use (%)</a></li><li><a href="#sar_mem_stat">Mem Stat (kb)</a></li><li><a href="#sar_swap_used">Swap Used (kb)</a></li><li><a href="#sar_swap_usepercent">Swap Used (%)</a></li><li><a href="#sar_swap_io">Swap Page IO</a></li><li><a href="#sar_paging_io">Paging IO</a></li><li><a href="#sar_paging_fault">Paging Fault</a></li><li><a href="#sar_paging_operate">Paging Operation</a></li><li><a href="#sar_paging_vmeff">Virtual Memory Efficiency</a></li></ul><li><li><a href="#lpa_l1_net">NET INFO</a><ul class="nav"><li><a href="#sar_net_ip_io">Network IP (IO)</a></li><li><a href="#sar_net_ip_asem">Network IP (Assemble)</a></li><li><a href="#sar_net_ip_err">Network IP (Errors)</a></li><li><a href="#sar_net_tcp_io">Network TCP (IO)</a></li><li><a href="#sar_net_tcp_err">Network TCP (Errors)</a></li><li><a href="#netstat_net_tcp_io">TCP ESTABLISH (Netstat)</a></li><li><a href="#netstat_net_tcp_tw">TCP IO TIME WAIT (Netstat)</a></li><li><a href="#netstat_net_tcp_fin">TCP FINISH (Netstat)</a></li></ul><li><li><a href="#lpa_l1_disk">DISK INFO</a><ul class="nav"><li><a href="#sar_disk_io_tps">Disk IO (tps)</a></li><li><a href="#sar_disk_io_read">Disk IO (Read)</a></li><li><a href="#sar_disk_io_write">Disk IO (Write)</a></li><li><a href="#sar_disk_io_await">Disk IO (Await Time)</a></li><li><a href="#sar_disk_io_util">Disk IO (Utilization)</a></li></ul><li><li><a href="#lpa_l1_ftrace">FUNC INFO</a><ul class="nav"></ul><li><li><a href="#lpa_l1_oprofile">PMC INFO</a><ul class="nav"><li><a href="#oprofile_event_cpu">Events (CPU and INST)</a></li><li><a href="#oprofile_event_llc">Events (LLC Miss/Refs)</a></li></ul><li>                            </ul>
                        </div>
                        <div><a href="#top" class="btn btn-info" style="position:fixed;bottom:10px;">TOP</a></div>
                    </div><!--sidebar-->
                </div>
            </div><!--tab datas-->
        </div><!--/div--><!--tab content-->
    </div>
    <!--div class="container1">
        <div class="col-sm-12">
            <div id="myTable" style="width:100%; height:400px;"></div>
        </div>
    </div-->
    <div><p style="text-align: center; margin-top: 20px;">CPD, VMWare Inc. 2014</p></div>
<script language="JavaScript">

        $(function() {
           createChart = function(id,start,seriesOptions,titlename){
            $(id).highcharts('StockChart', {
                          chart: {
                            events: {
                                load: function () {
                                    if (!window.isComparing) {
                                        this.setTitle(null, {
                                            text: 'Built chart in ' + (new Date() - start) + 'ms'
                                        });
                                    }
                                }
                            },
                            zoomType: 'x'
                        },

                        legend: {
                            enabled: true,
                            align: 'right',
                            //backgroundColor: '#FCFFC5',
                            //borderColor: 'black',
                            borderWidth: 2,
                            layout: 'vertical',
                            verticalAlign: 'top',
                            y: 100,
                            shadow: true
                        },

                        rangeSelector: {

                            buttons: [{
                                type: 'day',
                                count: 3,
                                text: '3d'
                            }, {
                                type: 'week',
                                count: 1,
                                text: '1week'
                            }, {
                                type: 'month',
                                count: 1,
                                text: '1m'
                            }, {
                                type: 'month',
                                count: 6,
                                text: '6m'
                            }, {
                                type: 'year',
                                count: 1,
                                text: '1y'
                            }, {
                                type: 'all',
                                text: 'All'
                            }],
                            selected: 1
                        },

                        yAxis: {
                            title: {
                                text: 'usage (%)',
                                minPadding:0,
                                startOnTick:false
                            }
                        },

                        title: {
                            text: titlename
                        },

                        subtitle: {
                            text: 'Built chart in ...' // dummy text to reserve space for dynamic subtitle
                        },

                        series : seriesOptions
                      });}
              $.getJSON('../static/data/cpu_process_time.json', function (cpuNames){
                var keys = Object.keys(cpuNames);
                var names = [];
                var id = '#processtime';
                var seriesOptions = [];
                var seriesCounter = 0;
                var titlename = 'CPU ProcessTime in ESXi, 2014-2015';

                for (var i = 0; i < cpuNames[keys].length; i++) {
                    names[i] = cpuNames[keys][i];
                }

                $.each(names, function (i, name) {
                  var start = +new Date();
                  $.getJSON('../static/data/' + name + '.json', function (data) {
                    
                       seriesOptions[i] = {
                            name: name,
                            data: data.data,
                            pointStart: data.pointStart*1000,
                            pointInterval: data.pointInterval*1000,
                            tooltip: {
                                valueDecimals: 1,
                                valueSuffix: '%'
                            }
                        };
                        seriesCounter += 1;
                        if (seriesCounter === names.length) {
                            createChart(id,start,seriesOptions,titlename);
                        }
                    });
                });
            });
            
              $.getJSON('../static/data/cpu_util_time.json', function (cpuNames){
                var keys = Object.keys(cpuNames);
                var names = [];
                var id = '#utiltime';
                var seriesOptions = [];
                var seriesCounter = 0;
                var titlename = 'CPU UtilTime in ESXi, 2014-2015';

                for (var i = 0; i < cpuNames[keys].length; i++) {
                    names[i] = cpuNames[keys][i];
                }

                $.each(names, function (i, name) {
                  var start = +new Date();
                  $.getJSON('../static/data/' + name + '.json', function (data) {
                    
                       seriesOptions[i] = {
                            name: name,
                            data: data.data,
                            pointStart: data.pointStart*1000,
                            pointInterval: data.pointInterval*1000,
                            tooltip: {
                                valueDecimals: 1,
                                valueSuffix: '%'
                            }
                        };
                        seriesCounter += 1;
                        if (seriesCounter === names.length) {
                            createChart(id,start,seriesOptions,titlename);
                        }
                    });
                });
            });
                var names = ['Kernel'];
                $.each(names, function (i, name) {
                    var start = +new Date();
                    var id = '#kernel';
                    var seriesOptions = [];
                    var seriesCounter = 0;
                    var titlename = 'CPU KernelMemory in ESXi, 2014-2015';
                    $.getJSON('../static/data/memory_kernel_mbytes.json', function (data) {
                   seriesOptions[i] = {
                        name: name,
                        data: data.data,
                        pointStart: data.pointStart*1000,
                        pointInterval: data.pointInterval*1000,
                        tooltip: {
                            valueDecimals: 1,
                            valueSuffix: '%'
                        }
                    };
                    seriesCounter += 1;
                    if (seriesCounter === names.length) {
                        createChart(id,start,seriesOptions,titlename);
                    }
                });
                });
                
                    var names = ['NonKernel'];
                    $.each(names, function (i, name) {
                        var start = +new Date();
                        var id = '#nonkernel';
                        var seriesOptions = [];
                        var seriesCounter = 0;
                        var titlename = 'CPU NonkernelMemory in ESXi, 2014-2015';
                        $.getJSON('../static/data/memory_nonkernel_mbytes.json', function (data) {
                       seriesOptions[i] = {
                            name: name,
                            data: data.data,
                            pointStart: data.pointStart*1000,
                            pointInterval: data.pointInterval*1000,
                            tooltip: {
                                valueDecimals: 1,
                                valueSuffix: '%'
                            }
                        };
                        seriesCounter += 1;
                        if (seriesCounter === names.length) {
                            createChart(id,start,seriesOptions,titlename);
                        }
                    });
                    });
                    
                        var names = ['KernelState'];
                        $.each(names, function (i, name) {
                            var start = +new Date();
                            var id = '#kernelstate';
                            var seriesOptions = [];
                            var seriesCounter = 0;
                            var titlename = 'CPU KernelState in ESXi, 2014-2015';
                            $.getJSON('../static/data/memory_kernel_state.json', function (data) {
                           seriesOptions[i] = {
                                name: name,
                                data: data.data,
                                pointStart: data.pointStart*1000,
                                pointInterval: data.pointInterval*1000,
                                tooltip: {
                                    valueDecimals: 1,
                                    valueSuffix: '%'
                                }
                            };
                            seriesCounter += 1;
                            if (seriesCounter === names.length) {
                                createChart(id,start,seriesOptions,titlename);
                            }
                        });
                        });
                        
                            var names = ['SwapUsed'];
                            $.each(names, function (i, name) {
                                var start = +new Date();
                                var id = '#swapused';
                                var seriesOptions = [];
                                var seriesCounter = 0;
                                var titlename = 'CPU Swap Used in ESXi, 2014-2015';
                                $.getJSON('../static/data/memory_pshare_shared_mbytes.json', function (data) {
                               seriesOptions[i] = {
                                    name: name,
                                    data: data.data,
                                    pointStart: data.pointStart*1000,
                                    pointInterval: data.pointInterval*1000,
                                    tooltip: {
                                        valueDecimals: 1,
                                        valueSuffix: '%'
                                    }
                                };
                                seriesCounter += 1;
                                if (seriesCounter === names.length) {
                                    createChart(id,start,seriesOptions,titlename);
                                }
                            });
                            });
                        
                            var names = ['SwapMBytesRead'];
                            $.each(names, function (i, name) {
                                var start = +new Date();
                                var id = '#swapmbread';
                                var seriesOptions = [];
                                var seriesCounter = 0;
                                var titlename = 'CPU Swap Read in ESXi, 2014-2015';
                                $.getJSON('../static/data/memory_swap_mbytes_read.json', function (data) {
                               seriesOptions[i] = {
                                    name: name,
                                    data: data.data,
                                    pointStart: data.pointStart*1000,
                                    pointInterval: data.pointInterval*1000,
                                    tooltip: {
                                        valueDecimals: 1,
                                        valueSuffix: '%'
                                    }
                                };
                                seriesCounter += 1;
                                if (seriesCounter === names.length) {
                                    createChart(id,start,seriesOptions,titlename);
                                }
                            });
                            });
                
                            var names = ['SwapMBytesWrite'];
                            $.each(names, function (i, name) {
                                var start = +new Date();
                                var id = '#swapmbwrite';
                                var seriesOptions = [];
                                var seriesCounter = 0;
                                var titlename = 'CPU Swap Write in ESXi, 2014-2015';
                                $.getJSON('../static/data/memory_swap_mbytes_read.json', function (data) {
                               seriesOptions[i] = {
                                    name: name,
                                    data: data.data,
                                    pointStart: data.pointStart*1000,
                                    pointInterval: data.pointInterval*1000,
                                    tooltip: {
                                        valueDecimals: 1,
                                        valueSuffix: '%'
                                    }
                                };
                                seriesCounter += 1;
                                if (seriesCounter === names.length) {
                                    createChart(id,start,seriesOptions,titlename);
                                }
                            });
                            });

        });
    createtable = function(myJSONobj,tableid,ifempty) {
        var irowmax = myJSONobj.records.length;
        //console.log(irowmax);
        var i, imax, shtml;
 
        //if (irowmax < 1) {
        //   alert ('No rows in table');
        //    return;
        //}
     
        var cols = [];
        //get an array of column names
        for (var key in myJSONobj.records[0]) {  //assumign all columns present in first record
            cols[cols.length] = key;
        }
     
        icolmax = cols.length
     
        shtml = "<table class='table'><tbody><tr>";          //create header row - save html of table in shtml
        for (i=0;i<icolmax;i++) {
            shtml += "<th>" + cols[i] + "</th>";
        }
        shtml += "</tr>";
     
     
        //var irowmax = myJSONobj.records.length;
     
        for (irow = 0; irow < irowmax; irow++) {  //add the rows
            if (myJSONobj.records[irow][cols[0]] === 1) {
                shtml += "<tr class='danger' data-toggle='tooltip' data-palcement='bottom'>";
                shtml += "<td>" + "<span class='label label-danger'>danger</span>" + "</td>";
            }
            else {
                shtml += "<tr class='warning' data-toggle='tooltip' data-palcement='bottom'>";
                shtml += "<td>" + "<span class='label label-warning'>warning</span>" + "</td>";
            }
            
            for (i=1;i<icolmax;i++) {
                if (i === 3) {
                    function fixZero(num,length){
                        var str=""+num;
                        var len=str.length;
                        var s="";
                        for(var i=length;i-->len;){
                        s+="0";
                        }
                        return s+str;
                        }
                    var date = new Date(myJSONobj.records[irow][cols[i]]*100000);
                    //date = date.getTime();
                    var nowdate = date.getFullYear()+"-"+fixZero(date.getMonth()+1,2)+"-"+fixZero(date.getDate(),2)+" "+fixZero(date.getHours(),2)+":"+fixZero(date.getMinutes(),2)+":"+fixZero(date.getSeconds(),2);
                    shtml += "<td>" + nowdate + "</td>";

                }
                else {
                    shtml += "<td>" + myJSONobj.records[irow][cols[i]] + "</td>";

                }
                
            }
            shtml += "</tr>";
        }
        shtml += "</tbody></table>";
        document.getElementById(tableid).innerHTML = shtml;
        if (irowmax < 1){
            document.getElementById(tableid).style.display="none";
        }
            
        

        
    }
    
    $.getJSON('../static/output/cpu_process_time0.json', function (myJSONobj){
        createtable(myJSONobj,"cputable1");   //write the table into div mydiv
    });
    $.getJSON('../static/output/cpu_process_time1.json', function (myJSONobj){
        createtable(myJSONobj,"cputable2");   //write the table into div mydiv
    });
    $.getJSON('../static/output/cpu_util_time0.json', function (myJSONobj){
        createtable(myJSONobj,"cputable3");  //write the table into div mydiv
    });
    $.getJSON('../static/output/cpu_util_time1.json', function (myJSONobj){
        createtable(myJSONobj,"cputable4");   //write the table into div mydiv

    });
    $.getJSON('../static/output/memory_kernel_mbytes.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable1");   //write the table into div mydiv
    });
    $.getJSON('../static/output/memory_kernel_state.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable2");   //write the table into div mydiv
    });
    $.getJSON('../static/output/memory_nonkernel_mbytes.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable3");   //write the table into div mydiv
    });
    $.getJSON('../static/output/memory_pshare_shared_mbytes.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable4");   //write the table into div mydiv
    });
    $.getJSON('../static/output/memory_swap_mbytes_read.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable5");   //write the table into div mydiv
    });
    $.getJSON('../static/output/memory_swap_mbytes_write.json', function (myJSONobj){
        createtable(myJSONobj,"memorytable6");   //write the table into div mydiv
    });
    $.getJSON('../static/output/logs.json', function (myJSONobj){
        createtable(myJSONobj,"allwarning");   //write the table into div mydiv
    });



</script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/docs.min.js"></script>
</body>
</html>

